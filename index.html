<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>Excel æ°£çƒé—–é—œéŠæˆ²</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- React -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Babel (ä¸€å®šè¦ï¼Œå¦å‰‡ JSX æœƒç©ºç™½) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-100">
  <div id="root"></div>

<script type="text/babel">

/* =========================
   é¡Œåº«ï¼ˆ15 é¡Œï¼‰
========================= */
const questionBank = [
  { id:1, question:'ç§»é™¤ A1 å‰å¾Œç©ºç™½', answer:'=TRIM(A1)', options:['=TRIM(A1)','=CLEAN(A1)','=LEFT(A1,6)'], points:120, color:'from-green-400 to-green-600' },
  { id:2, question:'å¹´é½¡ â‰¥65 äººæ•¸', answer:'=COUNTIF(B:B,">=65")', options:['=COUNTIF(B:B,">=65")','=COUNT(B:B)','=SUMIF(B:B,">=65")'], points:130, color:'from-green-400 to-green-600' },
  { id:3, question:'å–èº«åˆ†è­‰å­—è™Ÿ', answer:'=RIGHT(A1,10)', options:['=RIGHT(A1,10)','=MID(A1,5,10)','=LEFT(A1,10)'], points:140, color:'from-green-400 to-green-600' },

  { id:4, question:'è¨ˆç®—å®Œæ•´å¹´è³‡', answer:'=DATEDIF(A1,TODAY(),"Y")', options:['=DATEDIF(A1,TODAY(),"Y")','=(TODAY()-A1)/365','=YEAR(A1)'], points:160, color:'from-blue-400 to-blue-600' },
  { id:5, question:'å­˜æ´»ç‡ (%)', answer:'=ROUND(A1/B1*100,2)', options:['=ROUND(A1/B1*100,2)','=A1/B1*100','=ROUND(A1/B1,2)'], points:180, color:'from-blue-400 to-blue-600' },
  { id:6, question:'å¥³æ€§ä¸”å¹´é½¡>50', answer:'=COUNTIFS(B:B,"å¥³",C:C,">50")', options:['=COUNTIFS(B:B,"å¥³",C:C,">50")','=COUNTIF(B:B,"å¥³")','=SUMIFS(C:C,">50")'], points:190, color:'from-blue-400 to-blue-600' },

  { id:7, question:'Cr åŠ‘é‡èª¿æ•´', answer:'=IF(A1>2,"æ¸›é‡50%",IF(A1>=1,"æ¸›é‡25%","æ­£å¸¸"))',
    options:[
      '=IF(A1>2,"æ¸›é‡50%",IF(A1>=1,"æ¸›é‡25%","æ­£å¸¸"))',
      '=IF(A1>2,"æ¸›é‡50%","æ­£å¸¸")',
      '=IFS(A1>2,"æ¸›é‡50%",A1>=1,"æ¸›é‡25%")'
    ], points:230, color:'from-purple-500 to-fuchsia-600'
  },
  { id:8, question:'VLOOKUP ç²¾ç¢ºæŸ¥æ‰¾', answer:'=VLOOKUP(A1,$G$2:$H$100,2,0)',
    options:[
      '=VLOOKUP(A1,$G$2:$H$100,2,0)',
      '=VLOOKUP(A1,G2:H100,2,1)',
      '=MATCH(A1,G2:H100,0)'
    ], points:250, color:'from-purple-500 to-fuchsia-600'
  },
  { id:9, question:'é«˜è¡€å£“åˆ¤æ–·', answer:'=IF(OR(A1>=140,B1>=90),"é«˜è¡€å£“","æ­£å¸¸")',
    options:[
      '=IF(OR(A1>=140,B1>=90),"é«˜è¡€å£“","æ­£å¸¸")',
      '=IF(AND(A1>=140,B1>=90),"é«˜è¡€å£“","æ­£å¸¸")',
      '=OR(A1>=140,B1>=90)'
    ], points:280, color:'from-purple-500 to-fuchsia-600'
  },

  { id:10, question:'é ç®—åŸ·è¡Œç‡', answer:'=INT(A1/B1*100)', options:['=INT(A1/B1*100)','=ROUND(A1/B1*100,0)','=A1/B1'], points:120, color:'from-orange-400 to-red-600' },
  { id:11, question:'ç—…æ­·è™Ÿé•·åº¦æª¢æŸ¥', answer:'=IF(LEN(A1)=7,"OK","éŒ¯èª¤")', options:['=IF(LEN(A1)=7,"OK","éŒ¯èª¤")','=LEN(A1)=7','=ISTEXT(A1)'], points:140, color:'from-teal-400 to-cyan-600' },
  { id:12, question:'åŠ ç­è²»è¨ˆç®—', answer:'=A1*B1*1.5', options:['=A1*B1*1.5','=(A1+50%)*B1','=A1*1.5+B1'], points:110, color:'from-yellow-400 to-amber-600' },
  { id:13, question:'æœˆä»½å·®è¨ˆç®—', answer:'=DATEDIF(A1,TODAY(),"M")', options:['=DATEDIF(A1,TODAY(),"M")','=(TODAY()-A1)/30','=MONTH(TODAY())'], points:180, color:'from-cyan-400 to-blue-600' },
  { id:14, question:'å§“åé®ç½©', answer:'=LEFT(A1,1)&"O"&RIGHT(A1,1)', options:['=LEFT(A1,1)&"O"&RIGHT(A1,1)','=REPLACE(A1,2,1,"O")','=MID(A1,1,1)'], points:170, color:'from-pink-400 to-rose-600' },
  { id:15, question:'å­˜æ´»ç™¾åˆ†æ¯”', answer:'=ROUND(A1/B1*100,2)', options:['=ROUND(A1/B1*100,2)','=A1/B1','=PERCENT(A1/B1)'], points:160, color:'from-indigo-400 to-blue-600' }
];

/* =========================
   ä¸»ç¨‹å¼
========================= */
function App(){
  const [balloons,setBalloons] = React.useState([]);
  const [selected,setSelected] = React.useState(null);
  const [score,setScore] = React.useState(0);
  const [lives,setLives] = React.useState(5);

  React.useEffect(()=>{
    if(lives<=0) return;
    const spawn=setInterval(()=>{
      const q=questionBank[Math.floor(Math.random()*questionBank.length)];
      setBalloons(b=>[...b,{
        id:Date.now()+Math.random(),
        x:Math.random()*80+10,
        y:100,
        speed:0.7,
        q
      }]);
    },1800);
    return()=>clearInterval(spawn);
  },[lives]);

  React.useEffect(()=>{
    if(lives<=0) return;
    const move=setInterval(()=>{
      setBalloons(bs=>bs.map(b=>({...b,y:b.y-b.speed}))
        .filter(b=>{
          if(b.y<-10){ setLives(l=>l-1); return false; }
          return true;
        }));
    },40);
    return()=>clearInterval(move);
  },[lives]);

  if(lives<=0){
    return(
      <div className="h-screen flex items-center justify-center bg-slate-900">
        <div className="bg-white p-10 rounded-3xl text-center">
          <h1 className="text-4xl font-bold text-red-600 mb-4">GAME OVER</h1>
          <p className="text-xl">æœ€çµ‚åˆ†æ•¸ï¼š{score}</p>
        </div>
      </div>
    );
  }

  return(
    <div className="max-w-6xl mx-auto p-6 grid grid-cols-12 gap-6">
      <div className="col-span-7 bg-slate-200 h-[600px] relative rounded-3xl overflow-hidden">
        {balloons.map(b=>(
          <div key={b.id}
            onClick={()=>setSelected(b)}
            className="absolute flex flex-col items-center cursor-pointer"
            style={{left:`${b.x}%`,bottom:`${b.y}%`}}>
            <div className={`w-20 h-24 bg-gradient-to-br ${b.q.color}
              rounded-t-full flex items-center justify-center text-white font-bold`}>
              ğŸ’°{b.q.points}
            </div>
            <div className="w-0.5 h-8 bg-slate-400"></div>
          </div>
        ))}
      </div>

      <div className="col-span-5">
        <div className="bg-white p-6 rounded-3xl mb-4 shadow">
          <p>åˆ†æ•¸ï¼š{score}</p>
          <p>ç”Ÿå‘½ï¼š{lives}</p>
        </div>

        {selected && (
          <div className="bg-white p-6 rounded-3xl shadow">
            <p className="font-bold mb-4">{selected.q.question}</p>
            {selected.q.options.map(o=>(
              <button key={o}
                onClick={()=>{
                  if(o===selected.q.answer) setScore(s=>s+selected.q.points);
                  else setLives(l=>l-1);
                  setBalloons(b=>b.filter(x=>x.id!==selected.id));
                  setSelected(null);
                }}
                className="block w-full mb-2 p-3 border rounded hover:bg-blue-50">
                {o}
              </button>
            ))}
          </div>
        )}
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);

</script>
</body>
</html>
